package Pmd;

message Gm
{
	enum Param
	{
		StartUpGameRequestGmPmd_C        = 1;   //游戏区服启动时发送给GMServer的第一个消息
		StartUpGameReturnGmPmd_S         = 2;   //游戏区服启动协议返回
		SurportGameZoneRequestGmPmd_C    = 3;   //GMTool请求GMServer当前GM支持的区服
		SurportGameZoneReturnGmPmd_S     = 4;   //当前支持的游戏区服
        ReconnectKickoutGmSmd_S          = 5;   //踢下线

        //GM账号相关
		RequestLoginGmUserPmd_C          = 6;   //GM请求登陆验证
		ReturnLoginGmUserPmd_S           = 7;   //GM登陆验证结果
		GmConfigDataGmUserPmd_CS         = 8;   //GM配置文件
		SetPasswordGmUserPmd_C           = 9;   //更改密码
		ReturnPasswordGmUserPmd_S        = 10;  //更改密码返回
		AddNewGmUserPmd_C                = 11;  //新加账号
		ReturnAddNewGmUserPmd_S          = 12;  //新加账号返回
		GMAccountListGmUserPmd_CS        = 13;  //请求GM账号列表
		RequestDelGmUserPmd_C            = 14;  //删除GM账号
        ReturnDelGmUserPmd_S             = 15;  //删除GM账号返回
        RequestModifyPriGmUserPmd_C      = 16;  //更改GM权限
        ReturnModifyPriGmUserPmd_S       = 17;  //更改权限返回
        
        //公告相关
		BroadcastNewGmUserPmd_C          = 18;   //公告任务指令。该指令可用于公告的添加、修改、查询返回
        ReturnBroadcastNewGmUserPmd_S    = 19;   //公告返回
		BroadcastDeleteGmUserPmd_C       = 20;   //工具发给服务器的公告删除指令
        ReturnBroadcastDeleteGmUserPmd_S = 21;   //删除公告返回
		RequestBroadcastListGmUserPmd_C  = 22;   //公告查询
        ReturnBroadcastListGmUserPmd_S   = 23;   //公告列表
        
        //处罚玩家
        PunishUserGmUserPmd_C            = 24;   //处罚玩家
        ReturnPunishUserGmUserPmd_S      = 25;   //处罚玩家返回
        DeletePunishUserGmUserPmd_C      = 26;   //请求删除处罚
        ReturnDeletePunishUserGmUserPmd_S= 27;   //删除处罚结果
        RequestPunishListGmUserPmd_C     = 28;   //查询当前处罚记录  
        ReturnPunishListGmUserPmd_S      = 29;   //返回查询列表

        //奖励玩家
        RequestAwardTypeGmUserPmd_C      = 30;   //查询奖励类型ID
        ReturnAwardTypeGmUserPmd_S       = 31;   //返回道具类型
        RequestAwardUserGmUserPmd_C      = 32;   //请求给玩家发放道具
        ReturnAwardUserGmUserPmd_S       = 33;   //返回玩家道具发放结果

        stGmServerMessageGmUserCmd       = 34;   // GmServer发给工具端的弹出消息
        //玩家信息相关
        RequestUserInfoGmUserPmd_C       = 35;   //查询玩家基础信息
        ReturnUserInfoGmUserPmd_S        = 36;   //返回玩家基础信息
        RequestModifyUserInfoGmUserPmd_C = 37;   //更新玩家信息
        ReturnModifyUserInfoGmUserPmd_S  = 38;   //返回更新结果
        RequestUserPackageGmUserPmd_C    = 39;   //请求玩家背包
        ReturnUserPackageGmUserPmd_S     = 40;   //返回玩家背包
    }
}

//此协议统一用于游戏服启动时连接其他服务器的协议，GM连接改为RequestLoginGmUserPmd_C
message StartUpGameRequestGmPmd_C
{
	required string key 		= 1;
	required uint32 version 	= 2;
	optional string compress	= 3;		// 压缩算法 ["gzip", "flate", "zlib", "lzw"]
	optional string encrypt		= 4;		// 加密算法
	optional string encryptkey	= 5;		// 加密key
	required string username	= 6;
	required string password	= 7;
}

// 返回给区服务器的连接验证状态,这里也发送区信息的原因是考虑游戏服务器可能连接名字验证服务器比连接登陆服务器快
message StartUpGameReturnGmPmd_S
{
	required bool   ret     = 1;		    // 返回成功标志
	optional string retdesc = 2;			// 返回描述
}
//请求当前区服
message SurportGameZoneRequestGmPmd_C
{
    optional uint32 gameid  = 1;           //
}
message GameZone
{
    required uint32 zoneid   = 1;
    required string zonename = 2;
}
message SurportGameZoneReturnGmPmd_S
{
    repeated GameZone data  = 1;
}

message ReconnectKickoutGmSmd_S
{
    optional string desc       = 1;       //原因
}

//GM账号相关
message GmUserInfo
{
    optional uint32 gmid      = 1;       //id, 用于登陆返回
    optional string name      = 2;       //账号，创建账号使用
    optional string password  = 3;       //密码，创建账号使用
    optional uint32 pri       = 4;       //权限
    optional uint32 qmaxnum   = 5;       //最大接单数
    optional uint32 autorecv  = 6;       //是否自动接单，
    optional uint32 workstate = 7;       //工作状态
    optional uint32 winnum    = 8;       //客户端打开窗口的数量
    optional uint32 gameid    = 9;       //游戏ID，登陆后保存在GMServer，不返回给客户端
    optional uint32 bindip    = 10;      //绑定IP 
    optional string config    = 11;      //GM配置
}

//GMClient连接GMServer的第一个协议
message RequestLoginGmUserPmd_C 
{
	required string key 		= 1;
	required uint32 version 	= 2;
	optional string compress	= 3;  // 压缩算法 ["gzip", "flate", "zlib", "lzw"]
	optional string encrypt		= 4;  // 加密算法
	optional string encryptkey	= 5;  // 加密key
	required string username	= 6;
	required string password	= 7;
	optional uint32 logintype   = 8;  // 登陆方式 0: 客户端登陆， 1:web登陆
	optional uint32 loginip     = 9;  // 登陆IP，当登陆方式为1时，需传入
}
//登陆验证返回
message ReturnLoginGmUserPmd_S 
{
    optional uint32 retcode   = 1;   // 验证结果, 0登陆成功，1密码错误， 2账号不存在， 3未知错误，4账号正在使用，5版本号错误
    optional GmUserInfo data  = 2;   // Gm账号信息 
}
//GM配置
message GmConfigDataGmUserPmd_CS
{
    optional string data      = 1;   // gm账号配置
}
//更改密码
message SetPasswordGmUserPmd_C
{
    required string oldpassword = 1; //老密码
    required string newpassword = 2; //新密码
}
//更改密码返回
message ReturnPasswordGmUserPmd_S
{
    optional uint32 retcode   = 1;  //0成功，1失败
}
//添加GM账号
message AddNewGmUserPmd_C
{
    required GmUserInfo data  = 1;  //GM账号数据
}
//添加GM账号返回
message ReturnAddNewGmUserPmd_S
{
    optional uint32 retcode   = 1;  //0成功，1失败
}
//请求获取GM账号列表
message GmAccountListGmUserPmd_CS
{
    repeated GmUserInfo data  = 1;  //GM账号列表
}
//请求删除GM账号
message RequestDelGmUserPmd_C
{
    required uint32 gmid      = 1;  //Gmid
}
//删除结果
message ReturnDelGmUserPmd_S
{
    optional uint32 retcode   = 1;  //0成功，1失败
}
//更改权限
message RequestModifyPriGmUserPmd_C
{
    required uint32 gmid      = 1;  //gm账号ID
    required uint32 pri       = 2;  //修改后的权限
}
//更改权限返回
message ReturnModifyPriGmUserPmd_S
{
    optional uint32 retcode   = 1;  //0成功,其他失败
}

//GM权限标识
enum GMToolRightKey
{
    RightKey_Login              = 1;    // 登陆
    RightKey_AccountManage      = 2;    // 帐号管理 
    RightKey_Broadcast          = 4;    // 公告系统,停机公告、广播，通过类型区分 
    RightKey_ChatMonitor        = 8;    // 聊天监控 
    RightKey_Punish             = 16;   // 处罚玩家 
    RightKey_Award              = 32;   // 奖励；奖励道具之类的
    RightKey_PlayerInfo         = 64;   // 玩家信息查询 
    RightKey_PlayerInfoModify   = 128;  // 玩家信息修改，昵称、金钱之类
    RightKey_LogQuery           = 256;  // 操作日志查询 
    RightKey_OnlineQA           = 512;  // 在线答疑 
    //未实现
    /*
    RightKey_ProductionCenter   = 512;  // 产品中心权限 
    RightKey_Namecontrol        = 1024; // 名称插入修改 
    RightKey_SetRecvQuestion    = 2048; // 自动接单管理权限
    RightKey_NewVersion         = 4096; // 兵王2新版本公告控制 
    RightKey_GMCommand          = 8192; // 由GM工具发向游戏服务器的批量GM指令 
    */
}

//公告相关
message BroadcastInfo
{
    optional uint32 taskid      = 1;   //公告ID
    optional uint32 gameid      = 2;   //游戏ID
    optional uint32 zoneid      = 3;   //区服ID
    optional uint32 gmid        = 4;   //发布公告的GM ID
    optional uint32 countryid   = 6;   //国家ID
    optional uint32 sceneid     = 7;   //场景ID
    optional uint32 starttime   = 8;   //公告开始时间
    optional uint32 endtime     = 9;   //公告结束时间
    optional uint32 intervaltime=10;   //公告间隔时间
    optional uint32 btype       =11;   //公告类型
    optional string content     =12;   //公告内容
}
//公告任务指令。该指令可用于公告的添加、修改、查询返回,发送的时候请发送一条
message BroadcastNewGmUserPmd_C
{
    required BroadcastInfo data = 1;   //公告信息
}
//发布公告返回
message ReturnBroadcastNewGmUserPmd_S
{
    optional uint32 retcode     = 1;   //0成功，其他失败
    optional uint32 zoneid      = 2;   //区ID
    optional uint32 taskid      = 3;   //
    optional uint32 gmid        = 4;   //该字段需要返回，否则找不到对应的GMTool
}
//工具发给服务器的公告删除指令
message BroadcastDeleteGmUserPmd_C
{
    optional uint32 taskid      = 1;   //公告ID
    optional uint32 zoneid      = 2;   //区ID
    optional uint32 gmid        = 3;   //gm id
}
//删除返回
message ReturnBroadcastDeleteGmUserPmd_S
{
    optional uint32 retcode     = 1;   //0成功
    optional uint32 taskid      = 2;   //删除的公告ID
    optional uint32 zoneid      = 3;   //
    optional uint32 gmid        = 4;   //GM ID
}
//工具发给服务器的对未发送完毕的公告查询的指令  
message RequestBroadcastListGmUserPmd_C
{
    optional uint32 zoneid    = 1;    //区服ID
    optional uint32 sceneid   = 2;    //场景ID
    optional uint32 countryid = 3;
    optional uint32 btype     = 4;    //根据类型查找
    optional uint32 endtime   = 5;    //结束时间在此之后的
}
//公告列表
message ReturnBroadcastListGmUserPmd_S
{
    repeated BroadcastInfo data = 1; //
}

message PunishUserInfo
{
    optional uint32 taskid    = 1;   //处罚ID
    optional uint32 gameid    = 2;   //游戏ID
    optional uint32 zoneid    = 3;   //区服ID   
    optional uint32 charid    = 4;   //角色ID 
    optional string charname  = 5;   //角色名称
    optional uint32 ip        = 6;   //玩家IP(封停账号时使用，针对单个IP封停)
    optional uint32 gmid      = 7;   //封停的GM ID
    optional string reason    = 8;   //处罚原因
    optional uint32 ptype     = 9;   //处罚操作,1警告，2禁言，3自言自语，4关禁闭，5踢下线，6封号
    optional uint32 delay     = 10;  //处罚时长/剩余处罚时间，单位分钟
    optional uint32 waittime  = 11;  //延迟多久开始处罚
    optional uint32 punishtime= 12;  //下发处罚的时间戳

}
//处罚玩家、返回当前受处罚的玩家,支持批量处罚，返回消息是：ReturnPunishUserGmUserPmd_S
message PunishUserGmUserPmd_C
{
    required PunishUserInfo data = 1; //处罚玩家信息
}
//返回处罚结果
message ReturnPunishUserGmUserPmd_S
{
    optional uint32 retcode      = 1; //0成功，1失败 
    optional uint32 taskid       = 2; //处罚ID，游戏服返回时需带上
    optional uint32 zoneid       = 3; //
    optional uint32 gmid         = 4; //
}
//删除处罚
message DeletePunishUserGmUserPmd_C
{
    required uint32 taskid       = 1; //处罚ID
    optional uint32 zoneid       = 2; //
    optional uint32 gmid         = 3; //GM ID，返回时用于GMServer查找GMTool
}
//返回删除结果
message ReturnDeletePunishUserGmUserPmd_S
{
    optional uint32 retcode      = 1; //0成功，1失败 
    optional uint32 taskid       = 2; //处罚ID，游戏服返回时需带上
    optional uint32 zoneid       = 3; //
    optional uint32 gmid         = 4; //
}

//处罚当前所有处罚记录
message RequestPunishListGmUserPmd_C
{
    optional uint32 zoneid       = 1; //区服ID，0则表示查询当前游戏的所有区服的处罚记录
    optional uint32 charid       = 2; //根据玩家角色ID
    optional string charname     = 3; //根据玩家昵称
    optional uint32 gmid         = 4; //根据处罚gm来查找
    optional uint32 ptype        = 5; //根据类型来查找
    optional uint32 endtime      = 6; //根据结束时间来查找,查找该时间点之后还有效的处罚
}
message ReturnPunishListGmUserPmd_S
{
    repeated PunishUserInfo data = 1;
}

//玩家奖励、补偿
//请求相关道具类型
message RequestAwardTypeGmUserPmd_C
{
    optional uint32 zoneid      = 1; //区服ID
    optional uint32 gmid        = 2; //用于查找GMTool
}

message ItemInfo
{
    required uint32 itemid     = 1; //道具ID
    required string itemname   = 2; //道具名称
    optional uint32 itemnum    = 3; //道具数量，奖励、补偿玩家时使用
}
message ItemTypeInfo
{
    required uint32 itemtype   = 1; //道具类型
    required string typename   = 2; //类型名称
    repeated ItemInfo data     = 3; //道具
}
//返回相关道具类型
message ReturnAwardTypeGmUserPmd_S
{
    repeated ItemTypeInfo data = 1; //
    required uint32 zoneid     = 2; //
    required uint32 gmid       = 3; //
}
//请求补偿玩家
message RequestAwardUserGmUserPmd_C
{
    required uint32 zoneid     = 1;
    required uint32 charid     = 2; //
    repeated ItemTypeInfo data = 3; //补偿的道具、礼包等
    optional uint32 gmid       = 4; //
}
//补偿结果
message ReturnAwardUserGmUserPmd_S
{
    optional uint32 retcode   = 1; //
    optional uint32 zoneid    = 2; //
    optional uint32 charid    = 3; //
    required uint32 gmid      = 4; //
}

//玩家信息相关
message UserInfo
{
    optional uint32 zoneid      = 1;  //区ID
    optional uint32 charid      = 2;  //角色ID
    optional string charname    = 3;  //玩家昵称
    optional string profession  = 4;  //职业名称
    optional string countryname = 5;  //所属国家名称
    optional uint32 level       = 6;  //角色等级
    optional uint32 viplevel    = 7;  //Vip等级
    optional uint32 oldzoneid   = 8;  //合服前的区ID
    optional uint32 lastofftime = 9;  //最后一次登录时间
    optional uint32 lastloginip = 10; //最后一次登录IP
    optional uint32 gmlevel     = 11; //gm权限
    optional uint32 createtime  = 12; //角色创建时间
    optional uint32 isonline    = 13; //是否在线
    optional uint32 glodnum     = 14; //金币、钻石数（跟RMB类似的货币）
    optional uint32 money       = 15; //普通货币数(普通游戏币)
}
//请求玩家基础信息
message RequestUserInfoGmUserPmd_C
{
    required uint32 zoneid   = 1;
    optional uint32 charid   = 2; 
    optional string charname = 3;
    optional uint32 gmid     = 4; //gmID用于查找gmtool
}
//返回玩家信息
message ReturnUserInfoGmUserPmd_S
{
    required UserInfo data   = 1; //玩家信息
    required uint32 gmid     = 2; //
}
//查询玩家背包
message RequestUserPackageGmUserPmd_C
{
    required uint32 zoneid   = 1; //区ID
    optional uint32 charid   = 2; //角色ID
    optional string charname = 3; //角色名称
    optional uint32 gmid     = 4; //
}
//返回背包信息
message ReturnUserPackageGmUserPmd_S
{
    repeated ItemTypeInfo data = 1; //道具信息
    required uint32 zoneid     = 2; //
    required uint32 charid     = 3; //
    required uint32 gmid       = 4; //
}
//修改玩家信息
message RequestModifyUserInfoGmUserPmd_C
{
    required uint32 zoneid    = 1;
    required uint32 charid    = 2;
    required uint32 optype    = 3; //修改类型，1昵称，2等级，3vip等级，4gm权限，5金币(与RMB类似货币),6游戏币
    optional string charname  = 4; //修改昵称的时候需要
    optional uint32 opnum     = 5; //修改的最终结果
    optional uint32 gmid      = 6; //
}
//修改结果
message ReturnModifyUserInfoGmUserPmd_S
{
    optional uint32 retcode   = 1; //0成功，其他失败
    optional uint32 zoneid    = 2; //区服ID
    optional uint32 charid    = 3; //修改的角色ID
    optional uint32 gmid      = 4; //
}

message stGmServerMessageGmUserCmd
{
    optional uint32 type = 1;
    optional uint32 gmid = 2;
    optional bytes data = 3;
}
